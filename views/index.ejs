<!DOCTYPE html>
<html>
  <head>

  <meta charset="utf-8">
  <title><%= info.title %></title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/>
  <meta name="description" content="<%= info.description %>" />
  <meta name="author" content="">
  <link rel="stylesheet" href="stylesheets/style.css" />

  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
      <script src="lib/html5shiv/html5shiv.js"></script>
  <![endif]-->

  <!-- Fav and touch icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="icons/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="icons/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="icons/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="icons/apple-touch-icon-57-precomposed.png">
  <link rel="shortcut icon" href="icons/favicon.png">

</head>
<body ng-app="ReaderApp" >
  <div id="wrapper">
    <div id="content">
      <div id="content-inner" ng-view>
      </div>
    </div>

    <div id="sidebar" ng-controller="SidebarCtrl">
      <div id="logo">
        <img src="http://www.gravatar.com/avatar/<%= user.gravatar %>?s=30" alt="<%= user.uid %>" title="<%= user.uid %>" ng-click="showProfile()" />
        <h1><%= info.name %></h1>
      </div>
      <div class="list-group">
        <a href="#timeline/global" target="_self" class="list-group-item" title="View all fresh items [g h]" ng-class="{active: $root.currentPage == 'global'}">
          <span class="badge">{{globalSize}}</span>
          <span class="glyphicon glyphicon-fire"></span>
          All items
        </a>
        <a href="#timeline/archive" target="_self" class="list-group-item" title="View archived items [g a]" ng-class="{active: $root.currentPage == 'archive'}">
          <span class="badge">{{archiveSize}}</span>
          <span class="glyphicon glyphicon-floppy-disk"></span>
          Saved items
        </a>
        <a href="#manage" class="list-group-item" title="Manage your subscriptions [g u]" ng-class="{active: $root.currentPage == 'manage'}">
          <span class="glyphicon glyphicon-cog"></span>
          Manage
        </a>
      </div>

      <h2>
        <span ng-click="switchOrder()">Subscriptions ({{ timelines.length - 2 }})</span>
        <a href="/api/subscription/export" target="_blank" title="Export my feeds" style="float: right;">
          <span class="glyphicon glyphicon-cloud-download"></span>
        </a>
      </h2>
      <div class="list-group">
        <a
          href="#timeline/{{ timeline.feed.id }}"
          title="{{ timeline.feed.title }}"
          class="list-group-item"
          target="_self"
          ng-repeat="timeline in timelines | filter:isSubscription | orderBy:order"
          ng-class="{active: $root.currentPage == timeline.feed.id}">
          <span class="badge" ng-show="timeline.size">{{ timeline.size }}</span>
          {{ timeline.feed.title }}
        </a>
      </div>
      <!-- Copyright -->
      <div id="copyright">
        <p>&copy; 2013 NUNUX.org</p>
      </div>
    </div><! -- end sidebar -->
  </div><!-- end wrapper -->
</div>

<% if (env == 'production') {%>
<script src="javascripts/reader.min.js"></script>
<script>
if (window.applicationCache) {
  applicationCache.addEventListener('updateready', function() {
      if (confirm('An update is available. Reload now?')) {
      window.location.reload();
      }
  });
}
</script>
<% } else { %>
<script src="lib/jquery/jquery.min.js"></script>
<script src="lib/bootstrap/bootstrap.min.js"></script>
<script src="lib/moment/moment.min.js"></script>
<script src="lib/qrcode-generator/qrcode.js"></script>
<script src="lib/humane-js/humane.min.js"></script>
<script src="lib/mousetrap/mousetrap.min.js"></script>
<script src="lib/angular/angular.min.js"></script>
<script src="lib/angular/angular-sanitize.min.js"></script>
<script src="lib/ngUpload/ng-upload.min.js"></script>

<script src="javascripts/app.js"></script>
<script src="javascripts/modules/angular-mobile.js"></script>
<script src="javascripts/modules/angular-carousel.js"></script>
<script src="javascripts/modules/sidebar.js"></script>
<script src="javascripts/modules/timeline.js"></script>
<script src="javascripts/modules/manage.js"></script>
<script src="javascripts/modules/lazy.js"></script>
<script src="javascripts/modules/dialog.js"></script>
<script src="javascripts/modules/qrcode.js"></script>
<% } %>

<script>
function toggleMenu() {
  $('#wrapper').toggleClass('open');
}
</script>
<script type="text/ng-template" id="/views/profile.html">
  <img src="http://www.gravatar.com/avatar/<%= user.gravatar %>?s=100" alt="<%= user.uid %>" title="<%= user.uid %>" />
  <p>
    <strong><%= user.username %></strong>
    <br/>
    <%= user.uid %>
    <br/>
    <i>Register {{ <%= user.registrationDate %> | date | fromNow }}</i>
    <br/><br/>
    <a href='/logout' class='btn btn-danger'><span class='glyphicon glyphicon-off'></span> logout</a>
  </p>
</script>
</body>
</html>
